{% extends 'base.html' %}
{% block title %}All Notes{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <form class="d-flex" method="get">
    <input class="form-control me-2" type="search" name="q" value="{{ q }}" placeholder="Search notes...">
    <select class="form-select me-2" name="tag">
      <option value="">All tags</option>
      {% for t in all_tags %}
        <option value="{{ t.slug }}" {% if active_tag and t.slug == active_tag.slug %}selected{% endif %}>{{ t.name }}</option>
      {% endfor %}
    </select>
    <button class="btn btn-outline-primary" type="submit">Filter</button>
  </form>
  <a class="btn btn-primary" href="{% url 'note_create' %}">+ New Note</a>
  </div>

<div class="list-group">
  {% for n in notes %}
    <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" href="{% url 'note_detail' n.id %}" aria-label="Open note {{ n.title }}">
      <span>{% if n.is_pinned %}ðŸ“Œ {% endif %}{{ n.title }}{% if n.tags.all %} Â· <small class="text-muted">{% for t in n.tags.all %}#{{ t.name }} {% endfor %}</small>{% endif %}</span>
      <small class="text-muted">updated {{ n.updated|date:"Y-m-d H:i" }}</small>
    </a>
  {% empty %}
    <div class="alert alert-secondary">No notes yet.</div>
  {% endfor %}
</div>

<nav class="mt-3">
  <ul class="pagination">
    {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="?q={{ q }}&tag={{ active_tag.slug|default:'' }}&page={{ page_obj.previous_page_number }}">Previous</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    {% endif %}
    <li class="page-item active"><span class="page-link">{{ page_obj.number }}</span></li>
    {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?q={{ q }}&tag={{ active_tag.slug|default:'' }}&page={{ page_obj.next_page_number }}">Next</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
